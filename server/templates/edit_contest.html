{% extends 'base.html' %}

{% set verb = 'Add' if cid == 0 else 'Edit' %}

{% block title %}{{ verb }} Contest - Galaxy OJ{% endblock %}

{% block content %}
<div class="container">

    {% for errs in form.errors.values() %}
    {% for e in errs %}
    <div class="alert alert-danger" role='alert'>{{e}}</div>
    {% endfor %}
    {% endfor %}
    <h1>{{ verb }} Contest</h1>

    <ul id="edit_contest_tabs" class="nav nav-tabs">
        <li class="active"><a href="#basic" data-toggle="tab"> Basic Info </a> </li>
        <li><a href="#problems" data-toggle="tab"> Problems </a></li>
    </ul>

    <div id="edit_contest_tabsContent" class="tab-content">
        <div class="tab-pane fade in active" id="basic">
            <form action="{{url_for('admin.edit_contest',cid=cid)}}" method="POST">
                {{ form.hidden_tag() }}
                <div class="form-group">
                    {{form.title.label}}
                    {{form.title(class_="form-control")}}
                </div>
                <div class="form-group">
                    {{form.description.label}}
                    {{form.description(class_="form-control")}}
                </div>
                <div class="form-group">
                    {{form.start_time.label}}
                    {{form.start_time(class_="form-control", type="data")}}
                </div>
                <div class="form-group">
                    {{form.end_time.label}}
                    {{form.end_time(class_="form-control", type="data")}}
                </div>
                <div class="form-group">
                    {{form.password.label}}
                    {{form.password(class_="form-control", type="password")}}
                </div>
                {{form.submit(class_="btn btn-default")}}
            </form>
        </div>
        <div class="tab-pane fade" id="problems">
            <table class="table">
                <thead>
                    <tr>
                        <th>id</th>
                        <th>Title</th>
                        <th>Modify</th>
                    </tr>
                </thead>
                <tbody>
                    {% for p in problems %}
                    <tr>
                        <th scope="row">{{p.id}}</th>
                        <td><a href="{{url_for('oj.problem', pid=p.id)}}">{{p.title}}</a></td>
                        <td>
                            {% if cid == 0 %}
                            <a href="{{url_for('admin.edit_problem', pid=p.id)}}">Edit</a>
                            {% else %}
                            <a href="{{url_for('admin.edit_problem', cid=cid, pid=p.id)}}">Edit</a>
                            {% endif %}
                            /
                            <a href="{{url_for('admin.delete_problem', pid=p.id)}}">Delete</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <button class="btn btn-primary" type="input" onclick="window.open('{{url_for('admin.edit_problem', cid=cid)}}')"> New problem </button>
        </div>

        <script>
$(function () {
    $('#edit_contest_tabs li:eq(1) a').tab('show');
});
        </script>
        {% endblock %}
